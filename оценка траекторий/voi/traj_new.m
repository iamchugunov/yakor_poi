function [traj] = traj_new(zav, config)
    traj.all_poits_count = zav.count;
    traj.lifetime = zav.lifetime;
    traj.ID = zav.ID;
    traj.SV_approx = zav.SV_approx;
    traj.SV_interp = zav.SV_interp;
    traj.fil1 = filter_new(zav.SV_approx, zav.t0);
    traj.fil2 = filter_new(zav.SV_interp, zav.t0);
    traj.modes_percent = 100;
    traj.current_points_count = 0;
    traj.estimations_count = 1;
    traj.current_SV_approx = zav.SV_approx;
    traj.current_SV_interp = zav.SV_interp;
    traj.timestamps = zav.t0;
    traj.t0 = zav.t0;
    traj.current_t0 = zav.t_last;
    traj.t_last_estimation = zav.t0;
    traj.t_last_poit = zav.t_last;
    traj.all_poits = zav.poits;
    traj.last_4 = zav.last_4;
    traj.last_4_flag = zav.last_4_flag;
    traj.last_4_cord = zav.last_4_cord;
    traj.xy_valid = zav.xy_valid;
    traj.all_ToA = zav.ToA;
    traj.ToA = [];
    traj.current_poits = struct([]);
    traj.freq = zav.freq;
    traj.hard_nak_flag = 0;
    traj.T_nak_default = config.traj_T_nak;
    traj.modes_count = length(find([traj.freq] == 1090));
    
%     traj.current_SV_fil1 = zav.SV_approx;
%     traj.current_SV_fil2 = zav.SV_interp;
%     traj.SV_fil1 = zav.SV_approx;
%     traj.SV_fil2 = zav.SV_interp;
%     traj.Dx1 = [248943.396224333,8819.71440656607,189.900517108744,-345389.033649808,-12379.5754414779,-287.599071567403,193919.872639461,6742.86077788855,149.717341542425;8819.71440656561,588.698483658648,19.8640857890225,-12235.3609573422,-814.939472703589,-29.1799876093174,6725.60676352589,339.620928475034,9.63140190112756;189.900517108739,19.8640857890222,1.90410677113728,-274.552255505134,-28.3537297898972,-1.64169684258742,144.401576594705,9.43699096251196,0.336226588150061;-345389.033649803,-12235.3609573426,-274.552255505133,480188.747996357,17235.0596913143,393.014480316056,-270207.564990773,-9403.19996867193,-208.999781167614;-12379.5754414771,-814.939472703591,-28.3537297898977,17235.0596913136,1139.99948526761,39.9753209337169,-9493.64150783668,-479.512897072500,-13.6387516428201;-287.599071567374,-29.1799876093173,-1.64169684258746,393.014480316024,39.9753209337163,3.05648987224109,-215.370310033556,-13.6877473390135,-0.484089590598585;193919.872639409,6725.60676352457,144.401576594662,-270207.564990704,-9493.64150783529,-215.370310033566,331248.948083306,11979.1229437314,274.715785847962;6742.86077788730,339.620928474964,9.43699096250903,-9403.19996867040,-479.512897072417,-13.6877473390126,11979.1229437316,1021.82901022848,40.5802036933827;149.717341542413,9.63140190112604,0.336226588149966,-208.999781167605,-13.6387516428184,-0.484089590598558,274.715785847975,40.5802036933831,3.50153509400056];
%     traj.Dx2 = [248943.396224333,8819.71440656607,189.900517108744,-345389.033649808,-12379.5754414779,-287.599071567403,193919.872639461,6742.86077788855,149.717341542425;8819.71440656561,588.698483658648,19.8640857890225,-12235.3609573422,-814.939472703589,-29.1799876093174,6725.60676352589,339.620928475034,9.63140190112756;189.900517108739,19.8640857890222,1.90410677113728,-274.552255505134,-28.3537297898972,-1.64169684258742,144.401576594705,9.43699096251196,0.336226588150061;-345389.033649803,-12235.3609573426,-274.552255505133,480188.747996357,17235.0596913143,393.014480316056,-270207.564990773,-9403.19996867193,-208.999781167614;-12379.5754414771,-814.939472703591,-28.3537297898977,17235.0596913136,1139.99948526761,39.9753209337169,-9493.64150783668,-479.512897072500,-13.6387516428201;-287.599071567374,-29.1799876093173,-1.64169684258746,393.014480316024,39.9753209337163,3.05648987224109,-215.370310033556,-13.6877473390135,-0.484089590598585;193919.872639409,6725.60676352457,144.401576594662,-270207.564990704,-9493.64150783529,-215.370310033566,331248.948083306,11979.1229437314,274.715785847962;6742.86077788730,339.620928474964,9.43699096250903,-9403.19996867040,-479.512897072417,-13.6877473390126,11979.1229437316,1021.82901022848,40.5802036933827;149.717341542413,9.63140190112604,0.336226588149966,-208.999781167605,-13.6387516428184,-0.484089590598558,274.715785847975,40.5802036933831,3.50153509400056];
%     traj.last_f1_t0 = zav.t0;
%     traj.last_f2_t0 = zav.t0;
    
    
    traj.dop = zav.dop;
    traj.dops = zav.dop;
    
    if traj.dop < 20
        traj.T_nak = traj.T_nak_default;
    elseif traj.dop < 100
        traj.T_nak = traj.T_nak_default * 2;
    else
        traj.T_nak = traj.T_nak_default * 3;
    end

    figure(1)
    traj.t1 = plot(zav.last_4_cord(1,:),zav.last_4_cord(2,:),'x-');
    traj.t2 = text(zav.last_4_cord(1,:),zav.last_4_cord(2,:),num2str(traj.ID));
    pause(0.01)

end

